import{c as Re,d as Ge}from"./chunk-Z3WLGFDH.js";import{a as Ue}from"./chunk-MCQSURPA.js";import{$ as u,$a as ie,Ca as Z,D as De,Da as c,Fa as Ie,G as A,H as N,I as b,Ka as Be,La as Ve,Pa as Ee,Qa as m,Ra as ee,S as O,T as X,Ua as l,Wa as q,_ as f,aa as v,ba as we,bb as G,ca as R,da as H,ga as I,ia as C,ka as xe,pa as Le,pb as ke,qb as Ne,rb as te,sb as be,tb as Oe,y as Se}from"./chunk-3ZWTIYMJ.js";import{Aa as ue,C as ge,Fc as Me,Gc as Ae,Ha as _,Ia as P,La as z,M as fe,Mb as d,Mc as B,Nc as V,Oa as ve,Oc as E,Qb as Q,Sb as Fe,Wa as J,Wc as x,Xc as L,_a as ye,ac as s,d as ne,hd as Ce,ja as y,kc as T,lc as h,mc as M,nc as _e,oc as Pe,qc as W,sc as K,tc as Te,ub as he,wa as r,xd as k,zb as p}from"./chunk-5NRRMIXO.js";var He="Media",U=N({source:He,events:{opened:A(),closed:b()}});var ae={};ne(ae,{closedMediaPage:()=>Ye,loadMediaPage:()=>qe});var qe=f((i=r(u),a=r(C))=>i.pipe(v(U.opened),y(e=>{let t=a.get("userLocalId");return[m.genresAction.action({payload:{mediaType:e.mediaType}}),m.popularFilmsAction.action({payload:{mediaType:e.mediaType}}),m.topFilmsAction.action({payload:{mediaType:e.mediaType}}),ee.getFavouriteFilmsAction.action({payload:{userLocalId:t}})]})),{functional:!0}),Ye=f((i=r(u))=>i.pipe(v(U.closed),y(()=>[m.genresAction.clearAction(),m.popularFilmsAction.clearAction(),ee.addFavouriteFilmAction.clearAction(),ee.getFavouriteFilmsAction.clearAction(),m.topFilmsAction.clearAction()])),{functional:!0});var ze=X(ie.selectIsLoggedIn,l.selectGenres,l.selectDiscoveryFilmsAction,l.selectUpdatedDiscoveryFilms,l.selectDiscoveryFilmsFiltersBtn,q.selectFavouriteIds,(i,a,e,t,o,n)=>({isLoggedIn:i,discoveryFilms:t,genres:a,isLoading:e.inProgress,isShowFiltersButton:o,favouriteFilmsIds:n})),Je=X(ie.selectIsLoggedIn,l.selectNowPlayingFilmsAction,l.selectAiringTodayTvAction,l.selectUpdatedNowPlayingMedia,q.selectFavouriteIds,(i,a,e,t,o)=>({isLoggedIn:i,nowPlayingFilms:t,isLoading:a.inProgress||e.inProgress,favouriteFilmsIds:o})),Qe=X(ie.selectIsLoggedIn,l.selectGenresAction,l.selectGenres,l.selectPopularFilmsAction,l.selectUpdatedPopularFilms,l.selectTopFilmsAction,l.selectUpdatedTopFilms,q.selectFavouriteIds,q.selectGetFavouriteAllAction,(i,a,e,t,o,n,w,g,j)=>({isLoggedIn:i,genres:e,isPopularFilmsLoading:t.inProgress,popularFilms:o.slice(0,10),isTopFilmsLoading:n.inProgress,topFilms:w.slice(0,5),favouriteFilmsIds:g,isLoading:!Ee(a&&t&&n&&j)})),$={selectMediaViewModel:Qe,selectMediaAllViewModel:ze,selectMediaNowPlayingViewModel:Je};var se={};ne(se,{handleClosed:()=>Ze,handleOpened:()=>Xe,loadDiscoveryFilms:()=>ei});var We="MediaAllSection",S=N({source:We,events:{opened:A(),discoveryFilms:A(),closed:b()}});var Xe=f((i=r(u),a=r(C))=>i.pipe(v(S.opened),y(e=>[m.discoveryFilmsAction.action({payload:{page:e.page,filters:e.filters,mediaType:e.mediaType,moviePage:e.moviePage,route:e.route}})])),{functional:!0}),Ze=f((i=r(u))=>i.pipe(v(S.closed),y(()=>[m.discoveryFilmsAction.clearAction()])),{functional:!0}),ei=f((i=r(u))=>i.pipe(v(S.discoveryFilms),ge(({payload:a})=>m.discoveryFilmsAction.action({payload:{page:a.page,filters:a.filters,mediaType:a.mediaType,moviePage:a.moviePage,route:a.route}}))),{functional:!0});var me={};ne(me,{handleClosed:()=>oi,handleOpened:()=>ti,loadNowPlayingFilmsTriggered:()=>ri});var ii="MediaNowPlayingSection",D=N({source:ii,events:{opened:A(),loadNowPlayingFilmsTriggered:A(),closed:b()}});var ti=f((i=r(u),a=r(C))=>i.pipe(v(D.opened),y(({page:e,mediaType:t})=>t===I.Movie?[m.nowPlayingFilmsAction.action({payload:{page:e}})]:[m.airingTodayTvAction.action({payload:{page:e}})])),{functional:!0}),oi=f((i=r(u))=>i.pipe(v(D.closed),y(()=>[Ve.clearNowPlayingFilms()])),{functional:!0}),ri=f((i=r(u))=>i.pipe(v(D.loadNowPlayingFilmsTriggered),y(({page:a,mediaType:e})=>e===I.Movie?[m.nowPlayingFilmsAction.action({payload:{page:a}})]:[m.airingTodayTvAction.action({payload:{page:a}})])),{functional:!0});var le=()=>ue([we([ae,se,me])]);var $e=[{title:"\u0412\u0441\u0456",route:"all"},{title:"\u0417\u0430\u0440\u0430\u0437 \u0434\u0438\u0432\u043B\u044F\u0442\u044C\u0441\u044F",route:"now-playing"}];var F=class{constructor(){this.mediaData=ye(null)}setMediaData(a){this.mediaData.set(a)}};function ni(i,a){if(i&1&&(_e(0),M(1,"mm-hero-films",1),T(2,"div",2)(3,"h2",3),Me(4),x(5,"translate"),h(),M(6,"ui-route-tabset",4)(7,"router-outlet"),h(),T(8,"div",5),M(9,"mm-top-films",6)(10,"div",7),h(),Pe()),i&2){let e=Te(),t=E(0);p(),s("films",t.popularFilms)("mediaType",e.mediaType()),p(2),s("level",2),p(),Ae(L(5,8,e.mediaTexts.title)),p(2),s("tabs",e.mediaTabs),p(3),s("films",t.topFilms)("mediaType",e.mediaType()),p(),s("innerHTML",e.pageContent(),he)}}var oe=(()=>{class i{constructor(){this.mediaType=J(),this.moviePage=J(),this.pageContent=J(),this._store=r(O),this._mediaDataService=r(F),this.vm$=this._store.select($.selectMediaViewModel),this.mediaTabs=$e,this.mediaTexts=G.mediaPage}ngOnInit(){this._mediaDataService.setMediaData({moviePage:this.moviePage(),movieType:this.mediaType()}),this._store.dispatch(U.opened({mediaType:this.mediaType()}))}ngOnDestroy(){this._store.dispatch(U.closed())}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=d({type:i,selectors:[["mm-media"]],inputs:{mediaType:[1,"mediaType"],moviePage:[1,"moviePage"],pageContent:[1,"pageContent"]},decls:3,vars:4,consts:[[4,"uiSpinner"],[3,"films","mediaType"],[1,"mm-media__container","container","gradient-border"],["mmTitle","",1,"mm-media__title",3,"level"],[1,"mm-media__tabs",3,"tabs"],[1,"container"],[1,"gradient-border","gradient-border_bottom",3,"films","mediaType"],[1,"mm-media__content",3,"innerHTML"]],template:function(t,o){if(t&1&&(B(0),x(1,"async"),Fe(2,ni,11,10,"ng-container",0)),t&2){let n=V(L(1,1,o.vm$));p(2),s("uiSpinner",n.isLoading)}},dependencies:[k,Be,be,Oe,Ne,Ge,Re,Ue,Se],styles:[".mm-media__container[_ngcontent-%COMP%]{padding-top:60px}.mm-media__title[_ngcontent-%COMP%]{margin-bottom:54px;text-align:center}.mm-media__content[_ngcontent-%COMP%]{font-family:Gotham-Pro-Regular,sans-serif;font-size:16px;line-height:1.3;font-weight:400;padding-top:60px;color:var(--color-text)}"],changeDetection:0})}}return i})();var je=(()=>{class i{constructor(){this.MediaType=I,this.MixMoviePage=Z,this.pageContent=G.media.films}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=d({type:i,selectors:[["mm-films"]],decls:1,vars:3,consts:[[3,"mediaType","moviePage","pageContent"]],template:function(t,o){t&1&&M(0,"mm-media",0),t&2&&s("mediaType",o.MediaType.Movie)("moviePage",o.MixMoviePage.Movies)("pageContent",o.pageContent)},dependencies:[oe],encapsulation:2})}}return i})();var Ke=(()=>{class i{constructor(){this.MediaType=I,this.MixMoviePage=Z,this.pageContent=G.media.tv}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=d({type:i,selectors:[["mm-tv"]],decls:1,vars:3,consts:[[3,"mediaType","moviePage","pageContent"]],template:function(t,o){t&1&&M(0,"mm-media",0),t&2&&s("mediaType",o.MediaType.Tv)("moviePage",o.MixMoviePage.Tv)("pageContent",o.pageContent)},dependencies:[oe],encapsulation:2})}}return i})();var re=(()=>{class i{constructor(){this.mediaData=Ce(()=>this._mediaDataService.mediaData()),this._mediaDataService=r(F),this._localSessionService=r(xe),this._localStorageService=r(C),this._favouriteFilmsService=r(Le),this._destroyRef=r(ve)}initValues(){this.userLocalId=this._localStorageService.get("userLocalId")}loadCurrentPage(e){this.currentPage=this._localSessionService.get(this.mediaData().moviePage+e+R)?this._localSessionService.get(this.mediaData().moviePage+e+R):1}saveCurrentPage(e,t){this.currentPage=t,this._localSessionService.set(this.mediaData().moviePage+e+R,this.currentPage)}scrollToTopOnLoad(e,t){e.pipe(fe(o=>!o.isLoading),De(this._destroyRef)).subscribe(()=>{let o=document.querySelector(t);o&&Ie(o)})}toggleFavouriteFilm(e,t){this._favouriteFilmsService.onToggleFavouriteFilm(e.filmId,e.posterPath,e.title,e.voteAverage,e.releaseDate,e.genres,this.mediaData().movieType,t,this.userLocalId)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=d({type:i,selectors:[["ng-component"]],decls:0,vars:0,template:function(t,o){},styles:[".mm-media__filters[_ngcontent-%COMP%]{margin-top:60px;display:block}"]})}}return i})();var ce=(()=>{class i extends re{constructor(){super(...arguments),this._store=r(O),this.vm$=this._store.select($.selectMediaAllViewModel)}ngOnInit(){this.initValues(),this.loadSelectedFilters(),this.loadCurrentPage(c.All),this._store.dispatch(S.opened({mediaType:this.mediaData().movieType,moviePage:this.mediaData().moviePage,route:c.All,filters:this.currentFilters,page:this.currentPage}))}ngOnDestroy(){this._store.dispatch(S.closed())}loadSelectedFilters(){this.currentFilters=this._localSessionService.get(this.mediaData().moviePage+c.All+H)?this._localSessionService.get(this.mediaData().moviePage+c.All+H):this.currentFilters}loadFilmsByFilters(e){this.currentFilters=e,this.currentFilters?this._localSessionService.set(this.mediaData().moviePage+c.All+H,this.currentFilters):this._localSessionService.remove(this.mediaData().moviePage+c.All+H),this.currentPage=1,this._localSessionService.remove(this.mediaData().moviePage+c.All+R),this._handleLoadDiscoverFilms()}loadFilmsByPage(e){this.saveCurrentPage(c.All,e),this._handleLoadDiscoverFilms()}_handleLoadDiscoverFilms(){this._store.dispatch(S.discoveryFilms({payload:{page:this.currentPage,filters:this.currentFilters,mediaType:this.mediaData().movieType,moviePage:this.mediaData().moviePage,route:c.All}})),this.scrollToTopOnLoad(this.vm$,".mm-media__container")}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=z(i)))(o||i)}})()}static{this.\u0275cmp=d({type:i,selectors:[["mm-media-all"]],features:[Q],decls:4,vars:13,consts:[[1,"mm-media__filters",3,"clickedFilters","clickedResetFilters","genres","filters","isShowFiltersButton"],[3,"clickedPaginationBtn","clickedFavouriteButton","isLoading","films","currentPage","isVisibleTitle","isLoggedIn","mediaType","favouriteFilmsIds"]],template:function(t,o){if(t&1){let n=W();B(0),x(1,"async"),T(2,"mm-film-filters",0),K("clickedFilters",function(g){return _(n),P(o.loadFilmsByFilters(g))})("clickedResetFilters",function(){return _(n),P(o.loadFilmsByFilters())}),h(),T(3,"mm-films-list",1),K("clickedPaginationBtn",function(g){return _(n),P(o.loadFilmsByPage(g))})("clickedFavouriteButton",function(g){_(n);let j=E(0);return P(o.toggleFavouriteFilm(g,j.favouriteFilmsIds))}),h()}if(t&2){let n=V(L(1,10,o.vm$));p(2),s("genres",n.genres)("filters",o.currentFilters)("isShowFiltersButton",n.isShowFiltersButton),p(),s("isLoading",n.isLoading)("films",n.discoveryFilms)("currentPage",o.currentPage)("isVisibleTitle",!1)("isLoggedIn",n.isLoggedIn)("mediaType",o.mediaData().movieType)("favouriteFilmsIds",n.favouriteFilmsIds)}},dependencies:[k,ke,te],styles:[".mm-media__filters[_ngcontent-%COMP%]{margin-top:60px;display:block}"],changeDetection:0})}}return i})();var de=(()=>{class i extends re{constructor(){super(...arguments),this._store=r(O),this.vm$=this._store.select($.selectMediaNowPlayingViewModel)}ngOnInit(){this.initValues(),this.loadCurrentPage(c.NowPlaying),this._store.dispatch(D.opened({mediaType:this.mediaData().movieType,page:this.currentPage}))}ngOnDestroy(){this._store.dispatch(D.closed())}loadFilmsByPage(e){this.saveCurrentPage(c.NowPlaying,e),this._store.dispatch(D.loadNowPlayingFilmsTriggered({mediaType:this.mediaData().movieType,page:this.currentPage})),this.scrollToTopOnLoad(this.vm$,".mm-media__container")}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=z(i)))(o||i)}})()}static{this.\u0275cmp=d({type:i,selectors:[["mm-media-now-playing"]],features:[Q],decls:3,vars:10,consts:[[3,"clickedPaginationBtn","clickedFavouriteButton","isLoading","films","currentPage","isVisibleTitle","isLoggedIn","mediaType","favouriteFilmsIds"]],template:function(t,o){if(t&1){let n=W();B(0),x(1,"async"),T(2,"mm-films-list",0),K("clickedPaginationBtn",function(g){return _(n),P(o.loadFilmsByPage(g))})("clickedFavouriteButton",function(g){_(n);let j=E(0);return P(o.toggleFavouriteFilm(g,j.favouriteFilmsIds))}),h()}if(t&2){let n=V(L(1,7,o.vm$));p(2),s("isLoading",n.isLoading)("films",n.nowPlayingFilms)("currentPage",o.currentPage)("isVisibleTitle",!1)("isLoggedIn",n.isLoggedIn)("mediaType",o.mediaData().movieType)("favouriteFilmsIds",n.favouriteFilmsIds)}},dependencies:[te,k],styles:[".mm-media__filters[_ngcontent-%COMP%]{margin-top:60px;display:block}"],changeDetection:0})}}return i})();var yo=[{path:"movies",component:je,providers:[le(),F],children:[{path:"all",component:ce},{path:"now-playing",component:de},{path:"",redirectTo:i=>i.queryParams.section||"all",pathMatch:"full"}]},{path:"tv",component:Ke,providers:[le(),F],children:[{path:"all",component:ce},{path:"now-playing",component:de},{path:"",redirectTo:i=>i.queryParams.section||"all",pathMatch:"full"}]}];export{je as FilmsComponent,U as MediaActions,oe as MediaComponent,He as MediaFeatureKey,$ as MediaVmSelectors,Ke as TvComponent,Ye as closedMediaPage,qe as loadMediaPage,le as provideMediaStore,yo as routes};
